"use strict";var e=require("../index-59b7992d.cjs"),t=require("../session-e6db6732.cjs");require("../utils-9d882195.cjs"),require("../query-promise-2c5b43ab.cjs"),require("../column-builder-b48639f3.cjs"),require("../query-builder-2f2e8229.cjs");class r{constructor(e,t){this.name=e,this.value=t}build(e){return new n(e,this)}}class n{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}}class s extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new i(e,this.config)}}class i extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"bigint"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class o extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new l(e,this.config)}}class l extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}class u extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.length=t}build(e){return new c(e,this.config)}}class c extends t.MySqlColumn{constructor(){super(...arguments),this.length=this.config.length}getSQLType(){return void 0===this.length?"binary":`binary(${this.length})`}}class a extends t.MySqlColumnBuilder{build(e){return new p(e,this.config)}}class p extends t.MySqlColumn{getSQLType(){return"boolean"}mapFromDriverValue(e){return"boolean"==typeof e?e:1===e}}class m extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.length=t.length,this.config.enum=t.enum}build(e){return new y(e,this.config)}}class y extends t.MySqlColumn{constructor(){super(...arguments),this.length=this.config.length,this.enumValues=this.config.enum??[]}getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}class h extends t.MySqlColumnBuilder{constructor(e,t,r){super(e),this.config.fieldConfig=t,this.config.customTypeParams=r}build(e){return new d(e,this.config)}}class d extends t.MySqlColumn{constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}class S extends t.MySqlColumnBuilder{build(e){return new x(e,this.config)}}class x extends t.MySqlColumn{constructor(e,t){super(e,t)}getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}}class f extends t.MySqlColumnBuilder{build(e){return new q(e,this.config)}}class q extends t.MySqlColumn{constructor(e,t){super(e,t)}getSQLType(){return"date"}}class g extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.fsp=t?.fsp}build(e){return new M(e,this.config)}}class M extends t.MySqlColumn{constructor(e,t){super(e,t),this.fsp=t.fsp}getSQLType(){return`datetime${void 0===this.fsp?"":`(${this.fsp})`}`}mapFromDriverValue(e){return new Date(e)}}class b extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.fsp=t?.fsp}build(e){return new w(e,this.config)}}class w extends t.MySqlColumn{constructor(e,t){super(e,t),this.fsp=t.fsp}getSQLType(){return`datetime${void 0===this.fsp?"":`(${this.fsp})`}`}}class B extends t.MySqlColumnBuilderWithAutoIncrement{constructor(e,t,r){super(e),this.config.precision=t,this.config.scale=r}build(e){return new C(e,this.config)}}class C extends t.MySqlColumnWithAutoIncrement{constructor(){super(...arguments),this.precision=this.config.precision,this.scale=this.config.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`decimal(${this.precision},${this.scale})`:void 0===this.precision?"decimal":`decimal(${this.precision})`}}class T extends t.MySqlColumnBuilderWithAutoIncrement{constructor(e,t){super(e),this.config.precision=t?.precision,this.config.scale=t?.scale}build(e){return new v(e,this.config)}}class v extends t.MySqlColumnWithAutoIncrement{constructor(){super(...arguments),this.precision=this.config.precision,this.scale=this.config.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`double(${this.precision},${this.scale})`:void 0===this.precision?"double":`double(${this.precision})`}}class I extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.enumValues=t}build(e){return new V(e,this.config)}}class V extends t.MySqlColumn{constructor(){super(...arguments),this.enumValues=this.config.enumValues}getSQLType(){return`enum(${this.enumValues.map((e=>`'${e}'`)).join(",")})`}}class D extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new Q(e,this.config)}}class Q extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"float"}}class W extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new L(e,this.config)}}class L extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"int"}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}class $ extends t.MySqlColumnBuilder{build(e){return new A(e,this.config)}}class A extends t.MySqlColumn{getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}}class F extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new N(e,this.config)}}class N extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"mediumint"}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}class K extends t.MySqlColumnBuilderWithAutoIncrement{constructor(e,t){super(e),this.config.precision=t?.precision,this.config.scale=t?.scale}build(e){return new j(e,this.config)}}class j extends t.MySqlColumnWithAutoIncrement{constructor(){super(...arguments),this.precision=this.config.precision,this.scale=this.config.scale}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`real(${this.precision}, ${this.scale})`:void 0===this.precision?"real":`real(${this.precision})`}}class P extends t.MySqlColumnBuilderWithAutoIncrement{constructor(e){super(e),this.config.hasDefault=!0,this.config.autoIncrement=!0}build(e){return new O(e,this.config)}}class O extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"serial"}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}class U extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new k(e,this.config)}}class k extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"smallint"}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}class E extends t.MySqlColumnBuilder{constructor(e,t,r){super(e),this.config.textType=t,this.config.enumValues=r.enum}build(e){return new J(e,this.config)}}class J extends t.MySqlColumn{constructor(){super(...arguments),this.textType=this.config.textType,this.enumValues=this.config.enumValues??[]}getSQLType(){return this.textType}}class Y extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.fsp=t?.fsp}build(e){return new _(e,this.config)}}class _ extends t.MySqlColumn{constructor(){super(...arguments),this.fsp=this.config.fsp}getSQLType(){return`time${void 0===this.fsp?"":`(${this.fsp})`}`}}class R extends t.MySqlColumnBuilder{defaultNow(){return this.default(e.sql`(now())`)}onUpdateNow(){return this.config.hasOnUpdateNow=!0,this.config.hasDefault=!0,this}}class H extends t.MySqlColumn{constructor(){super(...arguments),this.hasOnUpdateNow=this.config.hasOnUpdateNow}}class z extends R{constructor(e,t){super(e),this.config.fsp=t?.fsp}build(e){return new G(e,this.config)}}class G extends H{constructor(){super(...arguments),this.fsp=this.config.fsp}getSQLType(){return`timestamp${void 0===this.fsp?"":`(${this.fsp})`}`}mapFromDriverValue(e){return new Date(e+"+0000")}mapToDriverValue(e){return e.toISOString().slice(0,19).replace("T"," ")}}class X extends R{constructor(e,t){super(e),this.config.fsp=t?.fsp}build(e){return new Z(e,this.config)}}class Z extends H{constructor(){super(...arguments),this.fsp=this.config.fsp}getSQLType(){return`timestamp${void 0===this.fsp?"":`(${this.fsp})`}`}}class ee extends t.MySqlColumnBuilderWithAutoIncrement{build(e){return new te(e,this.config)}}class te extends t.MySqlColumnWithAutoIncrement{getSQLType(){return"tinyint"}mapFromDriverValue(e){return"string"==typeof e?Number(e):e}}class re extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.length=t?.length}build(e){return new ne(e,this.config)}}class ne extends t.MySqlColumn{constructor(){super(...arguments),this.length=this.config.length}getSQLType(){return void 0===this.length?"varbinary":`varbinary(${this.length})`}}class se extends t.MySqlColumnBuilder{constructor(e,t){super(e),this.config.length=t.length,this.config.enum=t.enum}build(e){return new ie(e,this.config)}}class ie extends t.MySqlColumn{constructor(){super(...arguments),this.length=this.config.length,this.enumValues=this.config.enum??[]}getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}class oe extends t.MySqlColumnBuilder{build(e){return new le(e,this.config)}}class le extends t.MySqlColumn{getSQLType(){return"year"}}class ue{constructor(e,t){this.name=e,this.unique=t}on(...e){return new ce(this.name,e,this.unique)}}class ce{constructor(e,t,r){this.config={name:e,columns:t,unique:r}}using(e){return this.config.using=e,this}algorythm(e){return this.config.algorythm=e,this}lock(e){return this.config.lock=e,this}build(e){return new ae(this.config,e)}}class ae{constructor(e,t){this.config={...e,table:t}}}class pe{constructor(e){this.columns=e}build(e){return new me(e,this.columns)}}class me{constructor(e,t){this.table=e,this.columns=t}getName(){return`${this.table[t.MySqlTable.Symbol.Name]}_${this.columns.map((e=>e.name)).join("_")}_pk`}}class ye{constructor(e){this.schemaName=e,this.table=(e,r,n)=>t.mysqlTableWithSchema(e,r,n,this.schemaName),this.view=(e,r)=>t.mysqlViewWithSchema(e,r,this.schemaName)}}function he(e){return new ye(e)}const de=he;exports.ExtraConfigBuilder=t.ExtraConfigBuilder,exports.ForeignKey=t.ForeignKey,exports.ForeignKeyBuilder=t.ForeignKeyBuilder,exports.InlineForeignKeys=t.InlineForeignKeys,exports.ManualViewBuilder=t.ManualViewBuilder,exports.MySqlColumn=t.MySqlColumn,exports.MySqlColumnBuilder=t.MySqlColumnBuilder,exports.MySqlColumnBuilderWithAutoIncrement=t.MySqlColumnBuilderWithAutoIncrement,exports.MySqlColumnWithAutoIncrement=t.MySqlColumnWithAutoIncrement,exports.MySqlDatabase=t.MySqlDatabase,exports.MySqlDelete=t.MySqlDelete,exports.MySqlDialect=t.MySqlDialect,exports.MySqlInsert=t.MySqlInsert,exports.MySqlInsertBuilder=t.MySqlInsertBuilder,exports.MySqlSelect=t.MySqlSelect,exports.MySqlSelectBuilder=t.MySqlSelectBuilder,exports.MySqlSelectQueryBuilder=t.MySqlSelectQueryBuilder,exports.MySqlSession=t.MySqlSession,exports.MySqlTable=t.MySqlTable,exports.MySqlTransaction=t.MySqlTransaction,exports.MySqlUpdate=t.MySqlUpdate,exports.MySqlUpdateBuilder=t.MySqlUpdateBuilder,exports.MySqlView=t.MySqlView,exports.MySqlViewBase=t.MySqlViewBase,exports.MySqlViewConfig=t.MySqlViewConfig,exports.PreparedQuery=t.PreparedQuery,exports.QueryBuilder=t.QueryBuilder,exports.ViewBuilder=t.ViewBuilder,exports.ViewBuilderCore=t.ViewBuilderCore,exports.foreignKey=t.foreignKey,exports.mysqlTable=t.mysqlTable,exports.mysqlTableCreator=t.mysqlTableCreator,exports.mysqlTableWithSchema=t.mysqlTableWithSchema,exports.mysqlView=t.mysqlView,exports.mysqlViewWithSchema=t.mysqlViewWithSchema,exports.Check=n,exports.CheckBuilder=r,exports.Index=ae,exports.IndexBuilder=ce,exports.IndexBuilderOn=ue,exports.MySqlBigInt53=i,exports.MySqlBigInt53Builder=s,exports.MySqlBigInt64=l,exports.MySqlBigInt64Builder=o,exports.MySqlBinary=c,exports.MySqlBinaryBuilder=u,exports.MySqlBoolean=p,exports.MySqlBooleanBuilder=a,exports.MySqlChar=y,exports.MySqlCharBuilder=m,exports.MySqlCustomColumn=d,exports.MySqlCustomColumnBuilder=h,exports.MySqlDate=x,exports.MySqlDateBuilder=S,exports.MySqlDateString=q,exports.MySqlDateStringBuilder=f,exports.MySqlDateTime=M,exports.MySqlDateTimeBuilder=g,exports.MySqlDateTimeString=w,exports.MySqlDateTimeStringBuilder=b,exports.MySqlDecimal=C,exports.MySqlDecimalBuilder=B,exports.MySqlDouble=v,exports.MySqlDoubleBuilder=T,exports.MySqlEnumColumn=V,exports.MySqlEnumColumnBuilder=I,exports.MySqlFloat=Q,exports.MySqlFloatBuilder=D,exports.MySqlInt=L,exports.MySqlIntBuilder=W,exports.MySqlJson=A,exports.MySqlJsonBuilder=$,exports.MySqlMediumInt=N,exports.MySqlMediumIntBuilder=F,exports.MySqlReal=j,exports.MySqlRealBuilder=K,exports.MySqlSchema=ye,exports.MySqlSerial=O,exports.MySqlSerialBuilder=P,exports.MySqlSmallInt=k,exports.MySqlSmallIntBuilder=U,exports.MySqlText=J,exports.MySqlTextBuilder=E,exports.MySqlTime=_,exports.MySqlTimeBuilder=Y,exports.MySqlTimestamp=G,exports.MySqlTimestampBuilder=z,exports.MySqlTimestampString=Z,exports.MySqlTimestampStringBuilder=X,exports.MySqlTinyInt=te,exports.MySqlTinyIntBuilder=ee,exports.MySqlVarBinary=ne,exports.MySqlVarBinaryBuilder=re,exports.MySqlVarChar=ie,exports.MySqlVarCharBuilder=se,exports.MySqlYear=le,exports.MySqlYearBuilder=oe,exports.PrimaryKey=me,exports.PrimaryKeyBuilder=pe,exports.alias=function(t,r){return new Proxy(t,new e.TableAliasProxyHandler(r,!1))},exports.bigint=function(e,t){return"number"===t.mode?new s(e):new o(e)},exports.binary=function(e,t={}){return new u(e,t.length)},exports.boolean=function(e){return new a(e)},exports.char=function(e,t={}){return new m(e,t)},exports.check=function(e,t){return new r(e,t)},exports.customType=function(e){return(t,r)=>new h(t,r,e)},exports.date=function(e,t={}){return"string"===t.mode?new f(e):new S(e)},exports.datetime=function(e,t={}){return"string"===t.mode?new b(e,t):new g(e,t)},exports.decimal=function(e,t={}){return new B(e,t.precision,t.scale)},exports.double=function(e,t){return new T(e,t)},exports.float=function(e){return new D(e)},exports.getTableConfig=function(n){const s=Object.values(n[t.MySqlTable.Symbol.Columns]),i=[],o=[],l=[],u=Object.values(n[t.MySqlTable.Symbol.InlineForeignKeys]),c=n[e.Table.Symbol.Name],a=n[e.Table.Symbol.Schema],p=n[e.Table.Symbol.BaseName],m=n[t.MySqlTable.Symbol.ExtraConfigBuilder];if(void 0!==m){const e=m(n[t.MySqlTable.Symbol.Columns]);for(const s of Object.values(e))s instanceof ce?i.push(s.build(n)):s instanceof r?o.push(s.build(n)):s instanceof pe?l.push(s.build(n)):s instanceof t.ForeignKeyBuilder&&u.push(s.build(n))}return{columns:s,indexes:i,foreignKeys:u,checks:o,primaryKeys:l,name:c,schema:a,baseName:p}},exports.getViewConfig=function(r){return{...r[e.ViewBaseConfig],...r[t.MySqlViewConfig]}},exports.index=function(e){return new ue(e,!1)},exports.int=function(e){return new W(e)},exports.isMySqlSchema=function(e){return e instanceof ye},exports.json=function(e){return new $(e)},exports.longtext=function(e,t={}){return new E(e,"longtext",t)},exports.mediumint=function(e){return new F(e)},exports.mediumtext=function(e,t={}){return new E(e,"mediumtext",t)},exports.mysqlDatabase=he,exports.mysqlEnum=function(e,t){if(0===t.length)throw new Error(`You have an empty array for "${e}" enum values`);return new I(e,t)},exports.mysqlSchema=de,exports.primaryKey=function(...e){return new pe(e)},exports.real=function(e,t={}){return new K(e,t)},exports.serial=function(e){return new P(e)},exports.smallint=function(e){return new U(e)},exports.text=function(e,t={}){return new E(e,"text",t)},exports.time=function(e,t){return new Y(e,t)},exports.timestamp=function(e,t={}){return"string"===t.mode?new X(e,t):new z(e,t)},exports.tinyint=function(e){return new ee(e)},exports.tinytext=function(e,t={}){return new E(e,"tinytext",t)},exports.uniqueIndex=function(e){return new ue(e,!0)},exports.varbinary=function(e,t){return new re(e,t)},exports.varchar=function(e,t){return new se(e,t)},exports.year=function(e){return new oe(e)};
//# sourceMappingURL=index.cjs.map
