import{d as e,C as u,s as d,T as w,v as y}from"../index-b71998f1.mjs";import{C as x}from"../column-builder-592f0191.mjs";import{d as D,e as T}from"../session-b977ce56.mjs";export{B as BaseSQLiteDatabase,E as ExtraConfigBuilder,I as InlineForeignKeys,M as ManualViewBuilder,P as PreparedQuery,Q as QueryBuilder,c as SQLiteAsyncDialect,g as SQLiteDelete,f as SQLiteDialect,i as SQLiteInsert,h as SQLiteInsertBuilder,l as SQLiteSelect,j as SQLiteSelectBuilder,k as SQLiteSelectQueryBuilder,S as SQLiteSession,b as SQLiteSyncDialect,a as SQLiteTransaction,n as SQLiteUpdate,m as SQLiteUpdateBuilder,r as SQLiteView,q as SQLiteViewBase,p as ViewBuilder,V as ViewBuilderCore,s as sqliteTable,o as sqliteTableCreator,t as sqliteView,v as view}from"../session-b977ce56.mjs";import"../utils-e6870670.mjs";import"../query-builder-2fcde2f0.mjs";function L(t,n){return new Proxy(t,new e(n,!1))}class C{constructor(e,t){this.name=e,this.value=t}build(e){return new _(e,this)}}class _{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}}function N(e,t){return new C(e,t)}class U{constructor(e,t){this.reference=()=>{const{columns:t,foreignColumns:n}=e();return{columns:t,foreignTable:n[0].table,foreignColumns:n}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new K(e,this)}}class K{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}getName(){const{columns:e,foreignColumns:t}=this.reference(),n=e.map((e=>e.name)),s=t.map((e=>e.name));return`${[this.table[D.Symbol.Name],...n,t[0].table[D.Symbol.Name],...s].join("_")}_fk`}}function F(e){return new U((function(){const{columns:t,foreignColumns:n}=e();return{columns:t,foreignColumns:n}}))}class O extends x{constructor(){super(...arguments),this.foreignKeyConfigs=[]}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map((({ref:n,actions:s})=>((n,s)=>{const r=new U((()=>{const t=n();return{columns:[e],foreignColumns:[t]}}));return s.onUpdate&&r.onUpdate(s.onUpdate),s.onDelete&&r.onDelete(s.onDelete),r.build(t)})(n,s)))}}class $ extends u{}class J extends O{build(e){return new A(e,this.config)}}class A extends ${getSQLType(){return"blob"}mapFromDriverValue(e){return JSON.parse(e.toString())}mapToDriverValue(e){return Buffer.from(JSON.stringify(e))}}class z extends O{build(e){return new G(e,this.config)}}class G extends ${getSQLType(){return"blob"}}function H(e,t){return"json"===t?.mode?new J(e):new z(e)}class R extends O{constructor(e,t,n){super(e),this.config.fieldConfig=t,this.config.customTypeParams=n}build(e){return new W(e,this.config)}}class W extends ${constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function X(e){return(t,n)=>new R(t,n,e)}class Y extends O{constructor(e){super(e),this.config.autoIncrement=!1}primaryKey(e){return e?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class Z extends ${constructor(){super(...arguments),this.autoIncrement=this.config.autoIncrement}getSQLType(){return"integer"}}class ee extends Y{build(e){return new te(e,this.config)}}class te extends Z{}class ne extends Y{constructor(e,t){super(e),this.config.mode=t}defaultNow(){return this.default(d`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(e){return new se(e,this.config)}}class se extends Z{constructor(){super(...arguments),this.mode=this.config.mode}mapFromDriverValue(e){return"timestamp"===this.config.mode?new Date(1e3*e):new Date(e)}mapToDriverValue(e){const t=e.getTime();return"timestamp"===this.config.mode?Math.floor(t/1e3):t}}function re(e,t){return"timestamp"===t?.mode||"timestamp_ms"===t?.mode?new ne(e,t.mode):new ee(e)}const ie=re;class oe extends O{build(e){return new ue(e,this.config)}}class ue extends ${getSQLType(){return"numeric"}}function ae(e){return new oe(e)}class ce extends O{build(e){return new le(e,this.config)}}class le extends ${getSQLType(){return"real"}}function me(e){return new ce(e)}class fe extends O{constructor(e,t){super(e),this.config.enumValues=t.enum??[]}build(e){return new he(e,this.config)}}class he extends ${constructor(e,t){super(e,t),this.enumValues=this.config.enumValues}getSQLType(){return"text"}}function de(e,t={}){return new fe(e,t)}class pe{constructor(e,t){this.name=e,this.unique=t}on(...e){return new ge(this.name,e,this.unique)}}class ge{constructor(e,t,n){this.config={name:e,columns:t,unique:n,where:void 0}}where(e){return this.config.where=e,this}build(e){return new be(this.config,e)}}class be{constructor(e,t){this.config={...e,table:t}}}function we(e){return new pe(e,!1)}function ye(e){return new pe(e,!0)}function Se(...e){return new xe(e)}class xe{constructor(e){this.columns=e}build(e){return new Qe(e,this.columns)}}class Qe{constructor(e,t){this.table=e,this.columns=t}getName(){return`${this.table[D.Symbol.Name]}_${this.columns.map((e=>e.name)).join("_")}_pk`}}class De{constructor(e,t){this.name=e,this.column=t}build(e){return new Te(e,this)}}class Te{constructor(e,t){this.table=e,this.name=t.name,this.column=t.column}}function Le(e,t){return new De(e,t)}function ve(e){const t=Object.values(e[D.Symbol.Columns]),n=[],s=[],r=[],i=Object.values(e[D.Symbol.InlineForeignKeys]),o=e[w.Symbol.Name],u=e[D.Symbol.ExtraConfigBuilder];if(void 0!==u){const t=u(e[D.Symbol.Columns]);for(const o of Object.values(t))o instanceof ge?n.push(o.build(e)):o instanceof C?s.push(o.build(e)):o instanceof xe?r.push(o.build(e)):o instanceof U&&i.push(o.build(e))}return{columns:t,indexes:n,foreignKeys:i,checks:s,primaryKeys:r,name:o}}function Ce(e){return{...e[y],...e[T]}}export{_ as Check,C as CheckBuilder,K as ForeignKey,U as ForeignKeyBuilder,be as Index,ge as IndexBuilder,pe as IndexBuilderOn,Qe as PrimaryKey,xe as PrimaryKeyBuilder,Z as SQLiteBaseInteger,Y as SQLiteBaseIntegerBuilder,G as SQLiteBlobBuffer,z as SQLiteBlobBufferBuilder,A as SQLiteBlobJson,J as SQLiteBlobJsonBuilder,$ as SQLiteColumn,O as SQLiteColumnBuilder,W as SQLiteCustomColumn,R as SQLiteCustomColumnBuilder,te as SQLiteInteger,ee as SQLiteIntegerBuilder,ue as SQLiteNumeric,oe as SQLiteNumericBuilder,le as SQLiteReal,ce as SQLiteRealBuilder,D as SQLiteTable,he as SQLiteText,fe as SQLiteTextBuilder,se as SQLiteTimestamp,ne as SQLiteTimestampBuilder,T as SQLiteViewConfig,Te as Unique,De as UniqueBuilder,L as alias,H as blob,N as check,X as customType,F as foreignKey,ve as getTableConfig,Ce as getViewConfig,we as index,ie as int,re as integer,ae as numeric,Se as primaryKey,me as real,de as text,Le as unique,ye as uniqueIndex};
//# sourceMappingURL=index.mjs.map
