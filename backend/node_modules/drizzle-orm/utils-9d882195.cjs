"use strict";var e=require("./index-59b7992d.cjs");class t extends Error{constructor(e){super(e),this.name="DrizzleError"}static wrap(e,n){return e instanceof Error?new t(n?`${n}: ${e.message}`:e.message):new t(n??String(e))}}exports.DrizzleError=t,exports.TransactionRollbackError=class extends t{constructor(){super("Rollback")}},exports.applyMixins=function(e,t){for(const n of t)for(const t of Object.getOwnPropertyNames(n.prototype))Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(n.prototype,t)||Object.create(null))},exports.getTableColumns=function(t){return t[e.Table.Symbol.Columns]},exports.getTableLikeName=function(t){return t instanceof e.Subquery?t[e.SubqueryConfig].alias:t instanceof e.View?t[e.ViewBaseConfig].name:t instanceof e.SQL?void 0:t[e.Table.Symbol.IsAlias]?t[e.Table.Symbol.Name]:t[e.Table.Symbol.BaseName]},exports.mapResultRow=function(t,n,r){const o={},s=t.reduce(((t,{path:s,field:l},a)=>{let i;i=l instanceof e.Column?l:l instanceof e.SQL?l.decoder:l.sql.decoder;let c=t;for(const[t,u]of s.entries())if(t<s.length-1)u in c||(c[u]={}),c=c[u];else{const t=n[a],f=c[u]=null===t?null:i.mapFromDriverValue(t);if(r&&l instanceof e.Column&&2===s.length){const t=s[0];t in o?"string"==typeof o[t]&&o[t]!==e.getTableName(l.table)&&(o[t]=!1):o[t]=null===f&&e.getTableName(l.table)}}return t}),{});if(r&&Object.keys(o).length>0)for(const[e,t]of Object.entries(o))"string"!=typeof t||r[t]||(s[e]=null);return s},exports.mapUpdateSet=function(t,n){const r=Object.entries(n).filter((([,e])=>void 0!==e)).map((([n,r])=>r instanceof e.SQL?[n,r]:[n,new e.Param(r,t[e.Table.Symbol.Columns][n])]));if(0===r.length)throw new Error("No values to set");return Object.fromEntries(r)},exports.orderSelectedFields=function t(n,r){return Object.entries(n).reduce(((n,[o,s])=>{if("string"!=typeof o)return n;const l=r?[...r,o]:[o];return s instanceof e.Column||s instanceof e.SQL||s instanceof e.SQL.Aliased?n.push({path:l,field:s}):s instanceof e.Table?n.push(...t(s[e.Table.Symbol.Columns],l)):n.push(...t(s,l)),n}),[])};
//# sourceMappingURL=utils-9d882195.cjs.map
