import{C as e,e as t,u as n,T as s,P as o,m as r,l as a,V as c,v as i}from"./index-b71998f1.mjs";class l extends Error{constructor(e){super(e),this.name="DrizzleError"}static wrap(e,t){return e instanceof Error?new l(t?`${t}: ${e.message}`:e.message):new l(t??String(e))}}class f extends l{constructor(){super("Rollback")}}function u(s,o,r){const a={},c=s.reduce(((s,{path:c,field:i},l)=>{let f;f=i instanceof e?i:i instanceof t?i.decoder:i.sql.decoder;let u=s;for(const[t,s]of c.entries())if(t<c.length-1)s in u||(u[s]={}),u=u[s];else{const t=o[l],m=u[s]=null===t?null:f.mapFromDriverValue(t);if(r&&i instanceof e&&2===c.length){const e=c[0];e in a?"string"==typeof a[e]&&a[e]!==n(i.table)&&(a[e]=!1):a[e]=null===m&&n(i.table)}}return s}),{});if(r&&Object.keys(a).length>0)for(const[e,t]of Object.entries(a))"string"!=typeof t||r[t]||(c[e]=null);return c}function m(n,o){return Object.entries(n).reduce(((n,[r,a])=>{if("string"!=typeof r)return n;const c=o?[...o,r]:[r];return a instanceof e||a instanceof t||a instanceof t.Aliased?n.push({path:c,field:a}):a instanceof s?n.push(...m(a[s.Symbol.Columns],c)):n.push(...m(a,c)),n}),[])}function p(e,n){const r=Object.entries(n).filter((([,e])=>void 0!==e)).map((([n,r])=>r instanceof t?[n,r]:[n,new o(r,e[s.Symbol.Columns][n])]));if(0===r.length)throw new Error("No values to set");return Object.fromEntries(r)}function b(e,t){for(const n of t)for(const t of Object.getOwnPropertyNames(n.prototype))Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(n.prototype,t)||Object.create(null))}function y(e){return e[s.Symbol.Columns]}function d(e){return e instanceof r?e[a].alias:e instanceof c?e[i].name:e instanceof t?void 0:e[s.Symbol.IsAlias]?e[s.Symbol.Name]:e[s.Symbol.BaseName]}export{l as D,f as T,p as a,b,d as c,y as g,u as m,m as o};
//# sourceMappingURL=utils-e6870670.mjs.map
